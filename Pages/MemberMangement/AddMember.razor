@page "/addNewMember"
@using System.Net.Http
@using Membership_Management_UI.Models
@using Membership_Management_UI.Services
@inject HttpClient httpClient
@using Microsoft.AspNetCore.Components.Forms

<div class="container">
    <div class="row">
        <div class="col-lg-9">
            <h3>Add New Member</h3>
        </div>
        <div class="col-lg-3 text-right">
            <a href="/allMember" role="button" class="btn btn-secondary btn-sm">Back to List</a>
        </div>
    </div>

    <form @onsubmit="HandleValidSubmit" enctype="multipart/form-data">
        <div class="mt-4">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="Name">Name:</label>
                        <input id="Name" @bind="member.Name" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="Phone">Phone:</label>
                        <input id="Phone" @bind="member.Phone" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="PresentAddress">Present Address:</label>
                        <input id="PresentAddress" @bind="member.PresentAddress" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="PermanentAddress">Permanent Address:</label>
                        <input id="PermanentAddress" @bind="member.PermanentAddress" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="Dob">Date of Birth:</label>
                        <input type="date" id="Dob" @bind="member.Dob" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="MembershipAmount">Membership Amount:</label>
                        <input id="MembershipAmount" @bind="member.MembershipAmount" class="form-control" />
                    </div>

                    <div class="form-group">
                        <label for="ImageFile">Upload Image:</label>
                        <div class="custom-file">
                            <InputFile id="ImageFile" OnChange="@HandleFileSelected" class="custom-file-input" accept=".jpg,.jpeg,.png" />
                            <label class="custom-file-label" for="ImageFile"></label>
                        </div>
                    </div>
                </div>
            </div>
            <br />

            <div class="row">
                <div class="col-md-12">
                    <button type="submit" class="btn btn-primary" disabled="@submitting">
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: @((submitting) ? "inline-block" : "none")"></span>
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>






@code {
    private Member member = new Member();
    private Document doc = new Document();
    private bool submitting = false;
    [Inject]
    private IMemberService service { get; set; }
    [Inject]
    private NavigationManager navigation { get; set; }

    private async Task HandleValidSubmit()
    {
        submitting = true;
        await service.AddMember(member);
        navigation.NavigateTo("/allMember");
        submitting = false;
    }


    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        var file = e.File;
        member.ImageFile = file;
    }


}
